from CircleGenerator import circlegenerator
from astropy.io import fits
import numpy as np
import math as mt

'''
This code should find the points on a fits image that line up with the coords defined in CircleGenerator.py

TODO: Find a way to define the size of circles needed
      Import multiple fits files (consider array stacking with numpy)
      Figure out system to quantify results (average, highest etc)
'''


def mapper():

    '''
    Function: 
        mapper

    Purpose: 
        maps a set of coordinates onto an array, taking average value of pixels selected
        Currently uses the circlegenerator function but this could be changed in future to allow more diverse mapping

    Inputs: 
        Image in FITS format (Not able to be specified outside of the code for the time being)

    Outputs: 
        AvgValue (float): Average value of pixels covered by coordinates 
    '''
    
    with fits.open('150.17047000_2.21880000_cosmos_3dhst_F140W_sci.fits') as cutout: #Opens file in the with structure, file is auto closed once segment is exited
        data = cutout[0].data #data is loaded into a variable

    SideLength = mt.sqrt(data.size)

    x = SideLength/2

    r = input("Enter radius of galaxy to be observed")

    AGNext = circlegenerator(x,x,(r/5))

    innercircle = circlegenerator(x,x,(r/4)) #these lines should find the coords for three different bands within the agn, one close to the agn, one in the inner disk and one at the extent

    coords = circlegenerator(x,x,r) #This should be expanded to discs, rather than 2D circles so that an average can be taken over a whole area of the source
    #Otherwise, circles can be taken at different radii between these radii so that an average and progression is easier to calculate
    #Also, IPAC/NASA have an API that can be used to request images via the program, requires "Learning" XML lol

    

    
